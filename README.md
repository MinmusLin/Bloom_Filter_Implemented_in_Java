# Bloom Filter Implemented in Java

Bloom Filter implemented in Java.

基于 Java 语言实现的布隆过滤器。

## 布隆过滤器

布隆过滤器主要是为了解决海量数据的存在性问题。对于海量数据中判定某个数据是否存在且容忍轻微误差这一场景（比如缓存穿透、海量数据去重）来说，非常适合。

可以将布隆过滤器看作由二进制向量（或者说位数组）和一系列随机映射函数（哈希函数）两部分组成的数据结构。相比于 `List`、`Map`、`Set` 等数据结构，它占用空间更少并且效率更高，但是缺点是其返回的结果是概率性的，而不是非常准确的。理论情况下添加到集合中的元素越多，误报的可能性就越大。并且，存放在布隆过滤器的数据不容易删除。

布隆过滤器会使用一个较大的位数组来保存所有的数据，数组中的每个元素都只占用 1 bit，并且每个元素只能是 0 或者 1（代表 `false` 或者 `true`）。这样来算的话，申请一个 100w 个元素的位数组只占用 1000000 Bit / 8 = 125000 Byte = 125000 / 1024 KB ≈ 122 KB 空间。

## 布隆过滤器原理

当一个元素加入布隆过滤器中的时候，会进行如下操作：

1. 使用布隆过滤器中的哈希函数对元素值进行计算，得到哈希值（有几个哈希函数得到几个哈希值）。
2. 根据得到的哈希值，在位数组中把对应下标的值置为 1。

当我们需要判断一个元素是否存在于布隆过滤器的时候，会进行如下操作：

1. 对给定元素再次进行相同的哈希计算；
2. 得到值之后判断位数组中的每个元素是否都为 1，如果值都为 1，那么说明这个值在布隆过滤器中，如果存在一个值不为 1，说明该元素不在布隆过滤器中。

![](assets/2025-04-11_01-50-34.png)

不同字符串经过哈希函数计算出的位置可能相同，这种情况可以适当增加位数组大小或者调整哈希函数。

**布隆过滤器说某个元素存在，小概率会误判。布隆过滤器说某个元素不在，那么这个元素一定不在。**

## 布隆过滤器应用场景

1. **判断数据存在性**：
   * 判断一个数字是否存在于海量数字集中
   * 防止缓存穿透（判断请求的数据是否有效，避免直接绕过缓存请求数据库）
   * 垃圾邮件过滤（判断一个邮件地址是否在垃圾邮件列表中）
   * 黑名单（判断一个 IP 地址或手机号码是否在黑名单中）
2. **海量数据去重**：
   * 对海量 QQ 号 / 订单号去重

## 基于 Java 语言实现布隆过滤器

1. 一个合适大小的位数组的数据结构实现
2. 不同哈希函数的方法实现
3. 添加元素到位数组（布隆过滤器）的方法实现
4. 判断元素是否存在于位数组（布隆过滤器）中的方法实现
